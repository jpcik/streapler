@prefix rr: <http://www.w3.org/ns/r2rml#>.
@prefix sr: <http://purl.oclc.org/rsp/srml#>.
@prefix rml: <http://semweb.mmlab.be/ns/rml#>.
@prefix xsd: <http://www.w3.org/2001/XMLSchema#>.
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>.
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>.
@prefix obs: <http://knoesis.wright.edu/ssw/ont/sensor-observation.owl#>.
@prefix time: <http://www.w3.org/2006/time#>.
@prefix : <http://epfl.ch/mapping/>.

:UnitMap
  rml:logicalSource [    
    rml:source "src/test/resources/data/units.csv"; rr:tableName "observedProps"; rml:cache true; ];  
  rr:subjectMap [ 
    rr:template "http://knoesis.wright.edu/ssw/ont/weather.owl#{1}"].
  
:MeasureDataMap
  rr:subjectMap [ 
    rr:template "http://knoesis.wright.edu/ssw/MeasureData_{observed}_{sensor}_{time}"];
  rr:predicateObjectMap [ 
    rr:predicate rdf:type; rr:objectMap [ rr:constant obs:MeasureData]];
  rr:predicateObjectMap [ 
    rr:predicate obs:floatValue; rr:objectMap [ rr:column "value"; rr:datatype xsd:float; sr:var "value"]];
  rr:predicateObjectMap [ 
    rr:predicate obs:uom; rr:objectMap [ rr:parentTriplesMap :UnitMap; rr:child "observed"; rr:parent "2" ]].
 
:Params sr:params 
  [sr:param "time";    rr:column "time"],
  [sr:param "value";   rr:column "value"],
  [sr:param "obsprop"; rr:column "observed"] .
 
:ObservationMap  
  rml:logicalSource [
    rml:root true;
    rml:source "jdbc coso"; 
    rml:query "select * from sensordata"; 
    sr:queryParams :Params ];  
  rr:subjectMap [ 
    rr:template "http://knoesis.wright.edu/ssw/Observation_{observed}_{sensor}_{time}"];
  rr:predicateObjectMap [ 
    rr:predicate rdf:type; 
    rr:objectMap [ rr:template "http://knoesis.wright.edu/ssw/ont/weather.owl#{observed}Observation"]];
  rr:predicateObjectMap [ 
    rr:predicate obs:observedProperty; 
    rr:objectMap [ rr:template "http://knoesis.wright.edu/ssw/ont/weather.owl#_{observed}"; sr:var "obsprop"]];
  rr:predicateObjectMap [ 
    rr:predicate obs:procedure; 
    rr:objectMap [ rr:template "http://knoesis.wright.edu/ssw/System_{sensor}"]];
  rr:predicateObjectMap [ 
    rr:predicate obs:result; rr:objectMap [ rr:parentTriplesMap :MeasureDataMap]];
  rr:predicateObjectMap [ 
    rr:predicate obs:samplingTime; rr:objectMap [ rr:parentTriplesMap :InstantMap]].
        
:InstantMap
  rr:subjectMap [ 
    rr:template "http://knoesis.wright.edu/ssw/Instant_{time}"];
  rr:predicateObjectMap [ 
    rr:predicate rdf:type; rr:objectMap [ rr:constant time:Instant]];
  rr:predicateObjectMap [ 
    rr:predicate time:inXSDDateTime; rr:objectMap [ rr:column "time"; rr:datatype xsd:dateTime; sr:var "time"]].
 